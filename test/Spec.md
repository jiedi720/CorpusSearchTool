# 字幕语料库检索工具需求规格说明书

## 项目概述
开发一个基于 Python 的字幕语料库检索工具，能够输入某个单词或单词列表，在单个或多个字幕文件中查找该输入单词或列表里所有单词出现的台词，输出对应的完整台词、出现在哪一集的时间轴等信息。同时支持对Word文档、PDF文档、TXT文档、MD文档等多种文档格式进行检索。

## 功能模块说明

### 1. GUI界面模块 (`gui/` 目录)
- 使用 Tkinter 实现所有界面布局、组件样式及窗口初始化代码
- 优化用户视觉体验，消除窗口启动时的"视觉闪烁"现象
- 通过预先计算坐标并利用窗口撤回（Withdraw）机制，实现优雅的居中加载
- 实现现代化界面设计，包括标签、输入框、按钮、表格等组件
- 提供友好的用户交互反馈

### 2. 功能算法模块 (`function/` 目录)
- 实现程序功能的底层算法
- 负责字幕文件解析、文档文件解析、关键词检索、结果匹配等核心逻辑
- 支持多种字幕格式（SRT, ASS, VTT等）
- 支持多种文档格式（Word, PDF, TXT, MD等）
- 实现高效的文本搜索算法
- 提供结果排序和过滤功能

### 3. 主程序入口 (`CorpusSearchTool.py`)
- 位于根目录，仅作为程序启动入口
- 负责挂载 gui 模块
- 初始化应用程序配置
- 处理命令行参数（如果需要）

### 4. 配置管理模块
- 实现"若未指定输出目录则默认同源"的逻辑
- 程序关闭时将当前的输入与输出路径自动持久化保存至 `CorpusSearchTool.ini` 配置文件中
- 程序启动时优先读取该 `CorpusSearchTool.ini` 文件，恢复上一次运行时的目录设置
- 管理用户偏好设置

### 5. 文件选择模块
- 提供多种便捷的文件选择方式
- 增加拖拽选择的交互方式，提升用户体验和操作效率
- 同时支持传统的点击选择和现代的拖放操作
- 支持单个和多个文件选择
- 支持文件夹批量处理

### 6. 搜索引擎模块
- 实现精确匹配和模糊匹配功能
- 支持大小写敏感/不敏感选项
- 支持韩语/英语变形匹配功能（当输入为韩语或英语的单词原型时，也一并找不同时态，不同变形的形态）
- 支持正则表达式搜索
- 提供搜索历史记录功能
- **韩语高级检索系统**：
  - 使用kiwipiepy进行形态分析，判定词性（名词/副词/动词/形容词）
  - 动词/形容词自动还原为词典形，无论输入时的具体活用形态
  - 动词/形容词：动态识别并覆盖所有与词典形对应的实际出现形式
  - 名词/副词：仅包含原始关键词本身（严格匹配）
  - 生成完整的搜索记录，包含：
    - 用户输入的原始关键词
    - 系统判定的词典形
    - 基于词典形实际命中的所有变体形式列表
    - 最终命中的句子列表
- **搜索历史存储**：
  - 从JSON格式改为Markdown格式
  - 简化格式，移除"区分大小写"和"模糊匹配"字段
  - 只保留关键信息：关键词、时间、输入路径、输出路径、结果数量、关键词类型和正则表达式设置

### 7. 结果展示模块
- 以表格形式展示搜索结果
- 显示时间轴、原始文本和匹配的关键词
- 支持结果导出功能（CSV, TXT等格式）
- 提供结果筛选和排序功能

### 8. 打包部署模块
- 使用 spec 技能创建程序的 .spec 文件
- 确保生成的 .exe 文件标题栏正常显示图标
- 程序运行后能准确识别并读取同级目录下的配置文件
- 优化打包体积和启动速度

## 技术架构
- 语言：Python 3.x
- GUI框架：Tkinter
- 配置文件格式：INI
- 文件格式支持：字幕文件（SRT, ASS, VTT等）和文档文件（Word, PDF, TXT, MD等）

## 用户界面要求
- 支持多文件选择
- 支持关键词输入框
- 显示检索结果表格
- 包含时间轴信息
- 支持导出功能
- 现代化的UI设计
- 响应式布局

## 性能要求
- 快速检索大量字幕文件和文档
- 内存使用合理
- 响应迅速
- 支持后台处理大文件

## 可扩展性要求
- 采用严格的文件结构解耦模式
- 模块间低耦合高内聚
- 便于后续功能扩展
- 支持插件化功能添加